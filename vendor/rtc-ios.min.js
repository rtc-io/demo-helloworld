!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),(t.RTC||(t.RTC={})).IOS=e()}}(function(){return function e(t,n,r){function o(a,c){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";var r=e("rtc-proxy/mediastream"),o=e("rtc-proxy/peerconnection"),i=/\(iOS\;.*Mobile\/NICTA/,a=!1,c=!1;n.supported=function(){return"undefined"!=typeof navigator&&i.test(navigator.userAgent)};n.init=function(e,t){function n(){var e;return c?t():(document.removeEventListener("deviceready",n),e=window.console.log,console.log=function(){var t=[].slice.call(arguments).join(" ");try{NativeLog(t)}catch(e){alert(t)}e.apply(console,arguments)},"function"==typeof getUserMedia&&(navigator.getUserMedia=function(e,t,n){getUserMedia(e,function(e){t(new r(e))},n)}),c=!0,console.log("iOS plugin initialized, getUserMedia available = "+!!navigator.getUserMedia),void t())}return a?setTimeout(n,10):void document.addEventListener("deviceready",n)};n.attach=function(e,t){var n=s(t,(t||{}).el),r=n.getContext("2d"),o=0,i=0;e&&e.__orig&&(e=e.__orig),iOSRTC_onDrawRegi(e,function(e,t,n){var a=!1;try{var c=new Image;a=t!==o||n!==i,c.onload=function(){a&&(r.canvas.width=t,r.canvas.height=n),r.drawImage(c,0,0,t,n)},c.src=e}catch(e){console.log("encountered error while drawing video"),console.log("error: "+e.message)}o=t,i=n})},n.attachStream=function(e,t){var n=[],r=0,o=0;n=t.map(function(e){return e.el.getContext("2d")}),e&&e.__orig&&(e=e.__orig),iOSRTC_onDrawRegi(e,function(e,t,i){var a=!1;try{var c=new Image;a=t!==r||i!==o,c.onload=function(){n.forEach(function(e){a&&(e.canvas.width=t,e.canvas.height=i),e.drawImage(c,0,0,t,i)})},c.src=e}catch(e){console.log("encountered error while drawing video"),console.log("error: "+e.message)}r=t,o=i})};var s=n.prepareElement=function(e,t){var n,r,o=t instanceof HTMLVideoElement||t instanceof HTMLAudioElement,i=document.createElement("canvas"),a=o?t.parentNode:t;return console.log("preparing element, created canvas"),o?(console.log("getting computed style for the element"),n=window.getComputedStyle(t),console.log("getting client bounding rect"),r=t.getBoundingClientRect(),console.log("setting w and h"),i.width=r.width,i.height=r.height,i.className=t.className,console.log("inserting canvas"),a.insertBefore(i,t),a.removeChild(t)):a.appendChild(i),i};n.createIceCandidate=function(e){return console.log("creating ice candidate, keys: "+Object.keys(e).join(" ")),getRTCIceCandidate({sdpMLineIndex:(e||{}).sdpMLineIndex,candidate:(e||{}).candidate})},n.createConnection=function(e,t){return e.iceServers=(e.iceServers||[]).map(function(e){var t=(e||{}).url;return console.log("specifying ice url: "+t),{url:t}}),new o(getPeerConnection(e,t))},n.createSessionDescription=function(e){return getRTCSessionDescription(e)},"undefined"!=typeof document&&document.addEventListener("deviceready",function(){a=!0})},{"rtc-proxy/mediastream":3,"rtc-proxy/peerconnection":6}],2:[function(e,t){var n=e("eventemitter3"),r=e("cog/extend");t.exports=function(e,t,o,i){function a(e,t){var n=c(e);return"function"!=typeof e.__orig["on"+t]&&(e.__orig["on"+t]=function(){n.emit.apply(n,[t].concat([].slice.call(arguments)))}),n}function c(e){return e.__emitter||(e.__emitter=new n),e.__emitter}return(t||[]).forEach(function(t){e[t]=function(){var e=this.__orig&&this.__orig[t];return"function"==typeof e?e.apply(this.__orig,arguments):void console.warn("could not invoke: "+t)}}),(o||[]).forEach(function(t){var n=t[0],o=r({get:function(){return this.__orig&&this.__orig[n]}},t[1]);o.writable&&!o.set&&(o.set=function(e){this.__orig&&(this.__orig[n]=e)}),Object.defineProperty(e,n,o)}),(i||[]).forEach(function(t){Object.defineProperty(e,"on"+t,{get:function(){return c(this).listeners(t)[0]},set:function(e){var n=a(this,t);return e?void n.on(t,e):n.removeAllListeners(t)}})}),i&&(e.addEventListener=function(e,t){a(this,e).on(e,t)},e.removeEventListener=function(e,t){c(this).removeListener(e,t)}),e}},{"cog/extend":4,eventemitter3:5}],3:[function(e,t){function n(e){return this instanceof n?(this.__orig=e,void r(this,[],[["id",{enumerable:!0}],["ended",{enumerable:!0}]])):new n(e)}var r=e("./index");t.exports=n;var o=r(n.prototype,["getAudioTracks","getVideoTracks","getTrackById","addTrack","removeTrack"],[],["ended","addtrack","removetrack"]);o.clone=function(){return new n(this.__orig)}},{"./index":2}],4:[function(e,t){"use strict";t.exports=function(e){return[].slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)e[n]=t[n]}),e}},{}],5:[function(e,t){"use strict";function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){}r.prototype._events=void 0,r.prototype.listeners=function(e){if(!this._events||!this._events[e])return[];for(var t=0,n=this._events[e].length,r=[];n>t;t++)r.push(this._events[e][t].fn);return r},r.prototype.emit=function(e,t,n,r,o,i){if(!this._events||!this._events[e])return!1;var a,c,s,u=this._events[e],f=u.length,d=arguments.length,l=u[0];if(1===f){switch(l.once&&this.removeListener(e,l.fn,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,i),!0}for(c=1,a=new Array(d-1);d>c;c++)a[c-1]=arguments[c];l.fn.apply(l.context,a)}else for(c=0;f>c;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;default:if(!a)for(s=1,a=new Array(d-1);d>s;s++)a[s-1]=arguments[s];u[c].fn.apply(u[c].context,a)}return!0},r.prototype.on=function(e,t,r){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,r||this)),this},r.prototype.once=function(e,t,r){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(new n(t,r||this,!0)),this},r.prototype.removeListener=function(e,t,n){if(!this._events||!this._events[e])return this;var r=this._events[e],o=[];if(t)for(var i=0,a=r.length;a>i;i++)r[i].fn!==t&&r[i].once!==n&&o.push(r[i]);return this._events[e]=o.length?o:null,this},r.prototype.removeAllListeners=function(e){return this._events?(e?this._events[e]=null:this._events={},this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.EventEmitter=r,r.EventEmitter2=r,r.EventEmitter3=r,"object"==typeof t&&t.exports&&(t.exports=r)},{}],6:[function(e,t){function n(e){return this instanceof n?(this.__orig=e,void r(this,[],[["localDescription",{enumerable:!0}],["remoteDescription",{enumerable:!0}],["signalingState",{enumerable:!0}],["iceGatheringState",{enumerable:!0}],["iceConnectionState",{enumerable:!0}]])):new n(e)}var r=e("./index"),o=e("./mediastream");t.exports=n;var i=r(n.prototype,["createOffer","createAnswer","createDataChannel","setLocalDescription","setRemoteDescription","updateIce","addIceCandidate","close"],[],["negotiationneeded","icecandidate","signalingstatechange","addstream","removestream","iceconnectionstatechange","datachannel"]);i.addStream=function(e){return e?this.__orig.addStream(e.__orig||e):void 0},i.removeStream=function(e){return e?this.__orig.removeStream(e.__orig||e):void 0},i.getLocalStreams=function(){return this.__orig.getLocalStreams().map(o)},i.getRemoteStreams=function(){return this.__orig.getRemoteStreams().map(o)},i.getStreamById=function(e){var t=this.__orig.getStreamById(e);return t&&(t=new o(t)),t}},{"./index":2,"./mediastream":3}]},{},[1])(1)});
//# sourceMappingURL=rtc.min.js.map