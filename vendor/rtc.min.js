!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.RTC=e()}}(function(){return function e(t,n,r){function o(c,a){if(!n[c]){if(!t[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(i)return i(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[c]={exports:{}};t[c][0].call(l.exports,function(e){var n=t[c][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<r.length;c++)o(r[c]);return o}({1:[function(e,t){t.exports={constraints:{video:!0,audio:!0},signaller:"//switchboard.rtc.io",room:void 0,ice:[],channels:{chat:!0},localContainer:"#l-video",remoteContainer:"#r-video",plugins:[],options:{}}},{}],2:[function(e,t){function n(e){return function(t){t.dataset.peer=e}}function r(e,t){h(t)("capture",["constraints","options"],l)("attach",["capture","options"],u.local)("render-local",["attach"],d([v("+rtc"),v("+localvideo"),p.to((t||{}).localContainer||"#l-video")]))("start-conference",["capture"],e.addStream).on("error",c(e,t))}function o(e,t){return function(r,o){h(s({stream:o},t))("attach",["stream","options"],u)("render-remote",["attach"],d([v("+rtc"),v("+remotevideo"),n(r),p.to((t||{}).remoteContainer||"#r-video")])).on("error",c(e,t))}}function i(e){g('[data-peer="'+e+'"]').forEach(function(e){e.parentNode.removeChild(e)})}function c(){return function(e){console.error(e)}}var a=e("cog/defaults"),s=e("cog/extend"),u=e("rtc-attach"),l=e("rtc-capture"),f=e("rtc-quickconnect"),d=e("whisk/chain"),p=e("fdom/append"),v=e("fdom/classtweak"),g=e("fdom/qsa"),h=e("kgo");t.exports=function(t){var n;return t=a({},t,e("./defaultconfig.js")),t.options=s({room:t.room,ice:t.ice,plugins:t.plugins,expectedLocalStreams:t.constraints?1:0},t.options),n=f(t.signaller,t.options),n.on("call:ended",i).on("stream:added",o(n,t)),Object.keys(t.channels||{}).forEach(function(e){var r=t.channels[e];n.createDataChannel(e,r===!0?null:r)}),t.constraints&&r(n,t),n}},{"./defaultconfig.js":1,"cog/defaults":5,"cog/extend":6,"fdom/append":11,"fdom/classtweak":12,"fdom/qsa":13,kgo:14,"rtc-attach":16,"rtc-capture":17,"rtc-quickconnect":21,"whisk/chain":46}],3:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,a,s,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],c(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,a=new Array(o-1),s=1;o>s;s++)a[s-1]=arguments[s];n.apply(this,a)}else if(i(n)){for(o=arguments.length,a=new Array(o-1),s=1;o>s;s++)a[s-1]=arguments[s];for(u=n.slice(),o=u.length,s=0;o>s;s++)u[s].apply(this,a)}return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned){var o;o=c(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,c,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],c=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=c;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],4:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var o=document.createElement("div"),i=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return i.observe(o,{attributes:!0}),function(e){r.length||o.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],5:[function(e,t){"use strict";t.exports=function(e){return e=e||{},[].slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e}},{}],6:[function(e,t){"use strict";t.exports=function(e){return[].slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)e[n]=t[n]}),e}},{}],7:[function(e,t){t.exports=function(e){function t(t){return e[t]}function n(t,n){e[t]=n}function r(t){return delete e[t]}function o(){return Object.keys(e)}function i(){return Object.keys(e).map(function(t){return e[t]})}return"object"!=typeof e?e:{get:t,set:n,remove:r,delete:r,keys:o,values:i}}},{}],8:[function(e,t){"use strict";t.exports=function(e){var t,n,r,o="string"==typeof e||e instanceof String,i=/^\-?\d+\.?\d*$/;if(!o||e.length<2)return o&&i.test(e)?parseFloat(e):e;if("true"===e||"false"===e)return"true"===e;if("null"===e)return null;if(n=e.charAt(0),r=e.charAt(e.length-1),t="{"==n&&"}"==r||"["==n&&"]"==r||'"'==n&&'"'==r)try{return JSON.parse(e)}catch(e){}return i.test(e)?parseFloat(e):e}},{}],9:[function(e,t){"use strict";var n=[],r=[],o=[console],i=t.exports=function(e){function t(){return i=n.indexOf("*")>=0||n.indexOf(e)>=0}var i=t();return r[r.length]=t,function(){var t=[].slice.call(arguments);("string"==typeof t[0]||t[0]instanceof String)&&(t[0]=e+": "+t[0]),i&&o.forEach(function(e){e.log.apply(e,t)})}};i.reset=function(){return o=[],n=[],i.enable()},i.to=function(e){return o=o.concat(e||[]),i},i.enable=function(){return n=n.concat([].slice.call(arguments)),r.forEach(function(e){e()}),i}},{}],10:[function(e,t){"use strict";t.exports=function(e,t,n){function r(){e.apply(c,i||[]),a=Date.now()}var o,i,c,a=(n||{}).leading!==!1?0:Date.now(),s=(n||{}).trailing;return s=s||void 0===s,function(){var n=Date.now(),u=n-a;return clearTimeout(o),t>u?(i=[].slice.call(arguments,0),c=this,s&&(o=setTimeout(r,t-u))):(a=n,void e.apply(this,arguments))}}},{}],11:[function(e,t){"use strict";var n=t.exports=function(){return console.log("not yet implemented"),!1};n.to=function(e,t){function n(t){var n=e;return("string"==typeof n||n instanceof String)&&(n=document.querySelector(n)),n&&"function"==typeof n.appendChild?(n.appendChild(t),t):void 0}return t?n(t):n}},{}],12:[function(e,t){"use strict";var n=/[\s\,]\s*/,r={"+":"add","-":"remove","~":"toggle","!":"toggle"};t.exports=function(e,t){function o(e){return e.classList?(i.forEach(function(t){e.classList[t.op](t.cls)}),e):e}var i=e.trim().split(n).map(function(e){return{op:r[e.charAt(0)],cls:e.slice(1)}}).filter(function(e){return e.op});return t?o(t):o}},{}],13:[function(e,t){"use strict";var n=/^\.([\w\-]+)$/,r=/^#([\w\-]+)$/,o=/^[\w\-]+$/;t.exports=function(e,t){var i;return t=t||document,i=t===document&&r.test(e),i?[t.getElementById(RegExp.$1)]:Array.prototype.slice.call(n.test(e)?t.getElementsByClassName(RegExp.$1):o.test(e)?t.getElementsByTagName(e):t.querySelectorAll(e))}},{}],14:[function(e,t){function n(){function e(r,o,i){if(t)throw"No tasks or defaults may be set after kgo is in flight";if(1===arguments.length&&null!==r&&"object"==typeof r){if(n)throw"Defaults may be defined only once per kgo";for(var u in r){if(u in a)throw"A task is already defined for "+u;s[u]=r[u]}return n=!0,e}if("string"!=typeof r&&(i=o,o=r,r=(c++).toString()+"__returnless"),"function"==typeof o&&(i=o,o=[]),"function"!=typeof i)throw new Error("No function provided for task number "+Object.keys(a).length+" ("+r+")");if(r in s)throw"A default with the same name as this task ("+r+") has already been set";return a[r]={name:r,args:o,fn:i},e}var t,n,c=0,a={},s={};for(var u in o.prototype)e[u]=o.prototype[u];return e.apply(null,arguments),i(function(){t=!0,r(a,s,e)}),e}var r=e("./run"),o=e("events").EventEmitter,i="function"==typeof setImmediate?setImmediate:setTimeout;t.exports=n},{"./run":15,events:3}],15:[function(e,t){function n(e,t,n){this._task=e,this._args=t,this._done=n}function r(e,t,r,o){var i=e.name,a=e.args,s=(e.fn,[]);if(a)for(var u=0;u<a.length;u++){var l=a[u],f=l.match(c);if(f&&(l=l.slice(1)),!(l in t))return;f||s.push(t[l])}var d=new n(e,s,function(e,t){o(i,e,t)});r(i),d.run()}function o(e,t,n){var i;for(var c in e)i=e[c],r(i,t,function(t){delete e[t]},function(r,i,c){return i?void n.emit("error",i,r):(t[r]=c,void o(e,t,n))})}function i(e,t,n){var r={};for(var i in e)r[i]=e[i];o(r,t,n)}var c=/^\!.+/;n.prototype._count=1,n.prototype._runs=0,n.prototype.run=function(){var e,t=this,n=[];this._task.fn.apply(this,this._args.concat([function(r,o){n.push(o),t._runs++,r?(e=!0,t.done(r)):e||t._runs!==t._count||t.done(null,n)}]))},n.prototype.count=function(e){this._parallel=!0,this._count=e},n.prototype.done=function(e,t){return e?this._done(e):void this._done(null,this._parallel?t:t[0])},t.exports=i},{}],16:[function(e,t){var n=e("rtc-core/plugin"),r=e("cog/extend"),o=t.exports=function(e,t,r){function o(t,n){var r=(n||{}).autoplay,o="audio",i=(n||{}).el;return isValid=t&&"function"==typeof t.getVideoTracks,isValid&&t.getVideoTracks().length>0&&(o="video"),i=i||document.createElement(o),c&&c.createObjectURL?i.src=c.createObjectURL(e):i.srcObject?i.srcObject=e:i.mozSrcObject&&(i.mozSrcObject=e),(n||{}).muted&&(i.muted=!0,i.setAttribute("muted","")),(void 0===r||r)&&i.play(),i}var i,c="undefined"!=typeof window&&window.URL;return"function"==typeof t&&(r=t,t={}),(i=n((t||{}).plugins))?i.init(t,function(n){return n?r(n):"function"!=typeof i.attach?r(new Error("plugin must support the attach function")):void r(null,i.attach(e,t))}):void r(null,o(e,t))};o.local=function(e,t,n){"function"==typeof t&&(n=t,t={}),o(e,r({muted:!0},t),n)}},{"cog/extend":6,"rtc-core/plugin":20}],17:[function(e,t){var n=e("rtc-core/plugin"),r=e("rtc-core/detect");navigator.getUserMedia=navigator.getUserMedia||r.call(navigator,"getUserMedia"),t.exports=function(e,t,r){function o(e){r(null,e)}var i;return"function"==typeof t&&(r=t,t={}),(i=n((t||{}).plugins))?i.init(t,function(t){return t?r(t):"function"!=typeof navigator.getUserMedia?r(new Error("plugin does not support media capture")):void navigator.getUserMedia(e,o,r)}):"function"!=typeof navigator.getUserMedia?r(new Error("getUserMedia not supported")):void navigator.getUserMedia(e,o,r)}},{"rtc-core/detect":18,"rtc-core/plugin":20}],18:[function(e,t){"use strict";var n=e("detect-browser"),r=t.exports=function(e,t){var n,o,i,c=this||("undefined"!=typeof window?window:void 0);if(c)for(t=(t||["ms","o","moz","webkit"]).concat(""),n=t.length;n--;)if(o=t[n],i=o+(o?e.charAt(0).toUpperCase()+e.slice(1):e),"undefined"!=typeof c[i])return r.browser=r.browser||o.toLowerCase(),c[e]=c[i]};r.moz="undefined"!=typeof navigator&&!!navigator.mozGetUserMedia,r.browser=n.name,r.browserVersion=r.version=n.version},{"detect-browser":19}],19:[function(e,t,n){function r(e){return e.concat(e[1].exec(navigator.userAgent))}function o(e){return!!e[2]}for(var i=[["chrome",/Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-6].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/iPad\;\sCPU\sOS\s([0-9\._]+)/],["ios",/iPhone\;\sCPU\siPhone\sOS\s([0-9\._]+)/],["safari",/Safari\/([0-9\._]+)/]],r=i.map(r).filter(o)[0],c=r&&r[3].split(/[._]/).slice(0,3);c&&c.length<3;)c.push("0");n.name=r&&r[0],n.version=c&&c.join(".")},{}],20:[function(e,t){function n(e){return e&&"function"==typeof e.supported&&e.supported(o)}function r(e){var t=i.filter(function(t){return"function"==typeof e[t]});return t.length===i.length}var o=e("./detect"),i=["init"];t.exports=function(e){return[].concat(e||[]).filter(n).filter(r)[0]}},{"./detect":18}],21:[function(e,t){(function(n){"use strict";var r=e("rtc-tools"),o=e("mbus"),i=e("rtc-tools/cleanup"),c=r.logger("rtc-quickconnect"),a=(e("cog/defaults"),e("cog/extend")),s=e("cog/getable");t.exports=function(t,u){function l(e,t,n){M.set(e,{active:!1,pc:t,channels:s({}),data:n,streams:[]})}function f(e){var t=M.get(e);t&&(c("ending call to: "+e),t.channels.keys().forEach(function(n){var r=t.channels.get(n),o=[e,r,n];C.apply(C,["channel:closed"].concat(o)),C.apply(C,["channel:closed:"+n].concat(o)),r.onopen=null}),t.streams.forEach(function(t){C("stream:removed",e,t)}),M.delete(e),C("call:ended",e,t.pc),i(t.pc))}function d(e,t,r){var o=M.get(e),i=[].concat(t.getRemoteStreams());o.active=!0,o.streams=[].concat(t.getRemoteStreams()),t.onaddstream=v(e),t.onremovestream=g(e),c(C.id+" - "+e+" call start: "+i.length+" streams"),C("call:started",e,t,r),n.nextTick(function(){i.forEach(_(e))})}function p(){clearTimeout(q),O&&(P&&D.length<P||(q=setTimeout(function(){var e=a({},A,{room:k});C.announce(e),j=!0},0)))}function v(e){return function(t){c("peer "+e+" added stream"),E(e),_(e)(t.stream)}}function g(e){return function(t){c("peer "+e+" removed stream"),E(e),C("stream:removed",e,t.stream)}}function h(e){var t=M.get(e);if(!t)throw new Error("No active call for peer: "+e);return t}function m(e,t,n){function r(){var r=M.get(n.id),i=[n.id,e,n,t];c('reporting channel "'+e.label+'" ready, have call: '+!!r),clearInterval(o),e.onopen=null,r&&r.channels.set(e.label,e),c("triggering channel:opened events for channel: "+e.label),C.apply(C,["channel:opened"].concat(i)),C.apply(C,["channel:opened:"+e.label].concat(i))}var o;return c("channel "+e.label+" discovered for peer: "+n.id),"open"===e.readyState?r():(c("channel not ready, current state = "+e.readyState),e.onopen=r,void(o=setInterval(function(){c("checking channel state, current state = "+e.readyState),"open"===e.readyState&&r()},500)))}function y(e){e&&"undefined"!=typeof e.room&&(k=e.room)}function w(e){var t,n;e.room===k&&(t=r.createConnection(u,(u||{}).constraints),C("peer:connect",e.id,t,e),l(e.id,t,e),D.forEach(function(e){t.addStream(e)}),C.isMaster(e.id)?(c("is master, creating data channels: ",Object.keys(R)),Object.keys(R).forEach(function(n){m(t.createDataChannel(n,R[n]),t,e)})):t.ondatachannel=function(n){var r=n&&n.channel;r&&void 0!==R[r.label]&&m(r,t,e)},c("coupling "+C.id+" to "+e.id),n=r.couple(t,e.id,C,a({},u,{logger:o("pc."+e.id,C)})),C("peer:couple",e.id,t,e,n),n.once("connected",d.bind(null,e.id,t,e)),n.once("closed",f.bind(null,e.id)),C.isMaster(e.id)&&n.createOffer())}function x(e){e.allow=e.allow&&D.length>=P}function b(e){var t=e&&e.id,n=t&&M.get(t);return t&&!n?(c("received peer update from peer "+t+", no active calls"),w(e)):void 0}function _(e){var t=M.get(e);return function(n){C("stream:added",e,n,t&&t.data)}}function E(e){var t=M.get(e);t&&t.pc&&(t.streams=[].concat(t.pc.getRemoteStreams()))}var L="undefined"!=typeof location&&location.hash.slice(1),C=e("rtc-signaller")(t,u),S=(u||{}).ns||"",k=(u||{}).room,T=(u||{}).debug,O=!(u||{}).manualJoin,A={},j=!1,D=[],M=C.calls=s({}),R={},P=(C.plugins=(u||{}).plugins||[],parseInt((u||{}).expectedLocalStreams,10)||0),q=0;return k||(L||(L=location.hash=""+Math.pow(2,53)*Math.random()),k=S+"#"+L),T&&r.logger.enable.apply(r.logger,Array.isArray(c)?T:["*"]),C.on("peer:announce",w),C.on("peer:update",b),C.on("peer:leave",f),C.broadcast=C.addStream=function(e){return D.push(e),M.values().forEach(function(t){t.pc.addStream(e)}),p(),C},C.endCalls=function(){M.keys().forEach(f)},C.close=function(){C.endCalls(),C.leave()},C.createDataChannel=function(e,t){return M.keys().forEach(function(n){var r,o=M.get(n);o&&o.pc&&C.isMaster(n)&&(r=o.pc.createDataChannel(e,t),m(r,o.pc,o.data))}),R[e]=t||null,C},C.join=function(){O=!0,p()},C.reactive=function(){return u=u||{},u.reactive=!0,C},C.removeStream=function(e){var t=D.indexOf(e);return M.values().forEach(function(t){t.pc.removeStream(e)}),t>=0&&D.splice(t,1),C},C.requestChannel=function(e,t,n){var r=h(e),o=r&&r.channels.get(t);return o?(n(null,o),C):(C.once("channel:opened:"+t,function(e,t){n(null,t)}),C)},C.requestStream=function(e,t,n){function r(c){c===e&&(o=i.pc.getRemoteStreams()[t],o&&(C.removeListener("stream:added",r),n(null,o)))}var o,i=h(e);return(o=i.pc.getRemoteStreams()[t])?(n(null,o),C):(C.on("stream:added",r),C)},C.profile=function(e){return a(A,e),j&&C.announce(A),C},C.waitForCall=function(e,t){var n=M.get(e);return n&&n.active?(t(null,n.pc),C):void C.on("call:started",function n(r){r===e&&(C.removeListener("call:started",n),t(null,M.get(r).pc))})},P&&C.on("peer:filter",x),C.on("local:announce",y),p(),C}}).call(this,e("_process"))},{_process:4,"cog/defaults":5,"cog/extend":6,"cog/getable":7,mbus:22,"rtc-signaller":25,"rtc-tools":40,"rtc-tools/cleanup":36}],22:[function(e,t){var n=e("array-trie"),r=/[\.\:]/,o=t.exports=function(e,t,i){function c(t){var n,r=[].slice.call(arguments,1),o=u(t),a=o.join("."),s=p.get(o)||[];return v.forEach(function(e){e({name:a,args:r})}),n=[].concat(s).map(function(e){return e.apply(i||this,r)}),c.parent&&(n=n.concat(c.parent.apply(i||this,[e.concat(o)].concat(r)))),n}function a(e){e?p.set(u(e),[]):p=n()}function s(e){function t(){v.splice(v.indexOf(e),1)}return v.push(e),t}function u(e){return Array.isArray(e)?e:e.split(r)}function l(e,t){var n=p.get(u(e)),r=n?n.indexOf(t):-1;r>=0&&n.splice(r,1)}function f(e,t){var n=u(e),r=p.get(n);return r?r.push(t):p.set(n,[t]),c}function d(e,t){return f(e,function n(){var r=t.apply(this,arguments);return c.off(e,n),r})}var p=n(),v=[];return"function"==typeof e&&(t=e,e=""),e=e&&e.split(r)||[],c.clear=c.removeAllListeners=a,c.feed=s,c.on=c.addListener=f,c.once=d,c.off=c.removeListener=l,c.parent=t||e&&e.length>0&&o(),c}},{"array-trie":24}],23:[function(e,t){"use strict";function n(e,t,n,r,o,i){var c=["function ",e,"(a,l,h,",r.join(","),"){",i?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",o?".get(m)":"[m]"];return i?c.push(t.indexOf("c")<0?";if(x===y){return m}else if(x<=y){":";var p=c(x,y);if(p===0){return m}else if(p<=0){"):c.push(";if(",t,"){i=m;"),c.push(n?"l=m+1}else{h=m-1}":"h=m-1}else{l=m+1}"),c.push("}"),c.push(i?"return -1};":"return i};"),c.join("")}function r(e,t,r,o){var i=new Function([n("A","x"+e+"y",t,["y"],!1,o),n("B","x"+e+"y",t,["y"],!0,o),n("P","c(x,y)"+e+"0",t,["y","c"],!1,o),n("Q","c(x,y)"+e+"0",t,["y","c"],!0,o),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return i()}t.exports={ge:r(">=",!1,"GE"),gt:r(">",!1,"GT"),lt:r("<",!0,"LT"),le:r("<=",!0,"LE"),eq:r("-",!0,"EQ",!0)}},{}],24:[function(e,t){"use strict";function n(e,t,n){this.symbols=e,this.children=t,this.value=n}function r(){return new n([],[])}var o=e("binary-search-bounds");t.exports=r;var i=n.prototype;i.set=function(e,t){if(e.shape){for(var r=this,i=e.shape[0],c=0;i>c;++c){var a=e.get(c),s=o.ge(r.symbols,a);if(!(s<r.symbols.length&&r.symbols[s]===a)){for(var u=new n([],[],t),l=i-1;l>c;--l)u=new n([e.get(l)],[u]);return r.symbols.splice(s,0,a),r.children.splice(s,0,u),t}r=r.children[s]}return r.value=t}for(var r=this,i=e.length,c=0;i>c;++c){var a=e[c],s=o.ge(r.symbols,a);if(!(s<r.symbols.length&&r.symbols[s]===a)){for(var u=new n([],[],t),l=i-1;l>c;--l)u=new n([e[l]],[u]);return r.symbols.splice(s,0,a),r.children.splice(s,0,u),t}r=r.children[s]}return r.value=t},i.get=function(e){if(e.shape){for(var t=this,n=e.shape[0],r=0;n>r;++r){var i=e.get(r),c=o.eq(t.symbols,i);if(0>c)return;t=t.children[c]}return t.value}for(var t=this,n=e.length,r=0;n>r;++r){var i=e[r],c=o.eq(t.symbols,i);if(0>c)return;t=t.children[c]}return t.value}},{"binary-search-bounds":23}],25:[function(e,t){var n=e("cog/extend");t.exports=function(t,r){return e("./signaller.js")(t,n({connect:e("./primus-loader")},r))}},{"./primus-loader":33,"./signaller.js":35,"cog/extend":6}],26:[function(e,t){t.exports={dataEvent:"data",openEvent:"open",closeEvent:"close",errorEvent:"error",writeMethod:"write",closeMethod:"close",leaveTimeout:3e3}},{}],27:[function(e,t){"use strict";{var n=e("cog/logger")("rtc-signaller");e("cog/extend")}t.exports=function(e){function t(e,t){if(e&&t)for(var n in t)e[n]=t[n];return e}function r(t){var n={data:t,allow:!0};return e("peer:filter",n),n.allow}return function(o,i,c,a,s){var u,l=o[0];if(n("announce handler invoked, received data: ",l),l&&l.id&&l.id!==e.id){if(!r(l))return;return u=e.peers.get(l.id),e("peer:connected",l.id,l),u&&!u.inactive?(n("signaller: "+e.id+" received update, data: ",l),t(u.data,l),e("peer:update",l,c)):(u={id:l.id,roleIdx:[l.id,e.id].sort().indexOf(l.id),data:{}},t(u.data,l),clearTimeout(u.leaveTimer),u.inactive=!1,e.peers.set(l.id,u),e.autoreply&&!s&&e.to(l.id).send("/announce",e.attributes),e("peer:announce",l,u))}}}},{"cog/extend":6,"cog/logger":9}],28:[function(e,t){"use strict";t.exports=function(t,n){return{announce:e("./announce")(t,n),leave:e("./leave")(t,n)}}},{"./announce":27,"./leave":29}],29:[function(e,t){"use strict";t.exports=function(e,t){return function(n){var r=n[0],o=e.peers.get(r&&r.id);o&&(o.leaveTimer=setTimeout(function(){o.inactive=!0,e("peer:leave",r.id,o)},t.leaveTimeout)),e("peer:disconnected",r.id,o)}}},{}],30:[function(e,t){!function(e){"use strict";var n="cuid",r=0,o=4,i=36,c=Math.pow(i,o),a=function(e,t){var n="000000000"+e;return n.substr(n.length-t)},s=function(){return a((Math.random()*c<<0).toString(i),o)},u=function(){return r=c>r?r:0,r++,r-1},l=function(){var e,t="c",n=(new Date).getTime().toString(i),r=l.fingerprint(),c=s()+s();return e=a(u().toString(i),o),t+n+e+r+c};l.slug=function(){var e,t=(new Date).getTime().toString(36),n=l.fingerprint().slice(0,1)+l.fingerprint().slice(-1),r=s().slice(-2);return e=u().toString(36).slice(-4),t.slice(-2)+e+n+r},l.globalCount=function(){var e=function(){var e,t=0;for(e in window)t++;return t}();return l.globalCount=function(){return e},e},l.fingerprint=function(){return a((navigator.mimeTypes.length+navigator.userAgent.length).toString(36)+l.globalCount().toString(36),4)},e.register?e.register(n,l):"undefined"!=typeof t?t.exports=l:e[n]=l}(this.applitude||this)},{}],31:[function(e,t){"use strict";function n(e,t,o){return o=o||0,function(){var i,c,a,s,u,l,f=[].concat(t),d=[];for(i=e.filter(function(e){return"undefined"==typeof f[e.idx]}),c=i.length;c--;)if(a=i[c],"object"==typeof a){if(a.numeric)s=a.varname-o,arguments.length>s&&(f[a.idx]=arguments[s],d.indexOf(a.varname)<0&&(d[d.length]=a.varname));else if(arguments.length>0)for(u=(a.varname||"").split("."),f[a.idx]=arguments[arguments.length-1]||{};f[a.idx]&&u.length>0;)l=f[a.idx][u.shift()],f[a.idx]="undefined"!=typeof l?l:"";"undefined"!=typeof f[a.idx]&&a.modifiers&&(f[a.idx]=r(a.modifiers,f[a.idx]))}return i=e.filter(function(e){return e.numeric&&"undefined"==typeof f[e.idx]}),0===i.length?f.join(""):n(e,f,o+d.length)}}function r(e,t){for(var n=0,r=e.length;r>n;n++)t=e[n](t);return t}function o(e){for(var t,n,r=[],o=0,i=e.length;i>o;o++)t=e[o].split(":"),n=c[t[0].toLowerCase()],n&&(r[r.length]=n.apply(null,t.slice(1)));return r}var i=/\{\{\s*([^\}]+?)\s*\}\}/,c=e("./mods"),a=t.exports=function(e,t){for(var r,c,a,s,u=[],l=[],f=i.exec(e),d=0,p=(t||{}).ignoreNumeric;f;)r=e.slice(0,f.index),r&&(l[d++]=r),a=f[1].split(/\s*\|\s*/),f[1]=a[0],c=parseInt(f[1],10),s=!isNaN(c),p&&s?l[d++]=f[0]:u[u.length]={idx:d++,numeric:s,varname:s?c:f[1],modifiers:a.length>1?o(a.slice(1)):[]},e=e.slice(f.index+f[0].length),f=i.exec(e);return e&&(l[d++]=e),n(u,l)};a.error=function(e){var t=a(e);return function(e){var n;if(e)return n=new Error(t.apply(null,Array.prototype.slice.call(arguments,1))),n._original=e,n}}},{"./mods":32}],32:[function(e,t,n){"use strict";n.len=function(e,t){var n,r=parseInt(t,10);return t=isNaN(r)?t||" ":r,n="number"==typeof t,function(r){for(var o=r.toString().slice(0,e);o.length<e;)o=n?t+o:o+t;return o}}},{}],33:[function(e,t){"use strict";var n=/\/$/,r=e("formatter"),o=r("{{ signalhost }}{{ primusPath }}");t.exports=function(e,t,r){var i,c,a=document.createElement("a");return"function"==typeof t&&(r=t,t={}),a.href=e,c=o({signalhost:e.replace(n,""),primusPath:(t||{}).primusPath||"/rtc.io/primus.js"}),i=document.querySelector('script[src="'+c+'"]'),i&&"undefined"!=typeof Primus?r(null,Primus):i?void i.addEventListener("load",function(){r(null,Primus)}):(i=document.createElement("script"),i.src=c,i.onerror=r,i.addEventListener("load",function(){"/"!==a.pathname&&(Primus.prototype.pathname=a.pathname.replace(n,"")+Primus.prototype.pathname),r(null,Primus)}),void document.body.appendChild(i))}},{formatter:31}],34:[function(e,t){"use strict";var n=e("cog/logger")("rtc-signaller"),r=e("cog/jsonparse");t.exports=function(t,o){function i(e,n,o){var i=e[0].slice(1),c=e.slice(2).map(r);t.apply(t,[i].concat(c).concat([n,o]))}var c=e("./handlers")(t,o);return function(e){var o,a,s,u,l=e,f=!0,d=!1;if(!l||"primus"!==l.slice(0,6)){var p=t.id+"";if(n("signaller "+p+" received data: "+e),"/to"===l.slice(0,3)&&(f=l.slice(4,p.length+4)===p,f&&(o=l.slice(5+p.length).split("|").map(r),d=!0,o=o.map(r))),f&&(o=o||l.split("|").map(r),"string"==typeof o[0])){if(s=o[1],s&&s.id===t.id)return console.warn("got data from ourself, discarding");u=t.peers.get(s&&s.id)||s,"/"===o[0].charAt(0)?(a=c[o[0].slice(1)],"function"==typeof a?a(o.slice(2),o[0].slice(1),s,u,d):i(o,u,e)):t("data",o.slice(0,1).concat(o.slice(2)),s,u,d)}}}}},{"./handlers":28,"cog/jsonparse":8,"cog/logger":9}],35:[function(e,t){"use strict";var n=e("cog/logger")("rtc-signaller"),r=e("rtc-core/detect"),o=e("cog/defaults"),i=e("cog/extend"),c=e("mbus"),a=(e("cog/throttle"),e("cog/getable")),s=e("cuid"),u=["write","send"],l=["close","end"],f={version:"3.1.0"};t.exports=function(t,d){function p(){D.announce()}function v(){t.addEventListener("message",function(e){T(e.data)}),t.addEventListener("open",b),t.addEventListener("close",x)}function g(){t.on(d.dataEvent,T),t.on(d.openEvent,b),t.on(d.closeEvent,x),t.on(d.errorEvent,x)}function h(e){return"function"!=typeof A?D("error",new Error("no connect function")):void A(e,d,function(n,r){return n?D("error",n):(D._messenger=t=r.connect(e),void L())})}function m(e){return e.map(C).join("|")}function y(){return i({},j,{id:D.id})}function w(e){return t[e]}function x(e){e instanceof Error&&console.log("socket closed with error: ",e),q=!1,D("disconnected")}function b(){q=!0,D("open"),D("connected")}function _(){var e=t&&"undefined"!=typeof t.socket;return e?!1:t&&"undefined"!=typeof t.readyState&&t.readyState>=2}function E(e){return"function"==typeof e}function L(){if(S=[d.writeMethod].concat(u).map(w).filter(E)[0],k=[d.closeMethod].concat(l).map(w).filter(E)[0],D.process=T=e("./processor")(D,d),"function"!=typeof S)throw new Error('provided messenger does not implement a "'+d.writeMethod+'" write method');"function"==typeof t.on?g():"function"==typeof t.addEventListener&&v(),q=t.connected||!1,q||D.once("connected",function(){D.on("connected",p)}),setTimeout(D.bind(D,"init"),0)}function C(e){return"object"!=typeof e||e instanceof String?"function"==typeof e?null:e:JSON.stringify(e)}var S,k,T,O=(d||{}).autoreply,A=(d||{}).connect,j={},D=c("",(d||{}).logger),M=D.id=(d||{}).id||s(),R=D.attributes={browser:r.browser,browserVersion:r.browserVersion,id:M,agent:"signaller@"+f.version},P=D.peers=a({}),q=!1,I=0,U=D.send=function(){var e,n=[].slice.call(arguments);return n.splice(1,0,y()),e=m(n),_()?void 0:q?S.call(t,e):D.once("connected",function(){S.call(t,e)})};return D.announce=function(e,t){function n(){(t||U)("/announce",R),D("local:announce",R)}return clearTimeout(I),i(R,e,{id:D.id}),q&&(D.removeListener("connected",p),D.on("connected",p)),I=setTimeout(function(){return q?void n():D.once("connected",n)},(d||{}).announceDelay||10)},D.isMaster=function(e){var t=P.get(e);return t&&0!==t.roleIdx},D.leave=D.close=function(){U("/leave",{id:M}),D.removeListener("connected",p),"function"==typeof k&&k.call(t)},D.metadata=function(e){return 0===arguments.length?i({},j):void(j=i({},e))},D.to=function(e){var r=function(){var r,o=D.peers.get(e);if(!o)throw new Error("Unknown peer: "+e);o.inactive||(r=["/to",e].concat([].slice.call(arguments)),r.splice(3,0,y()),setTimeout(function(){var o=m(r);n("TX ("+e+"): "+o),S.call(t,o)},0))};return{announce:function(e){return D.announce(e,r)},send:r}},d=o({},d,e("./defaults")),D.autoreply=void 0===O||O,"string"==typeof t||t instanceof String?h(t):L(),D._messenger=t,D.process=T,D}},{"./defaults":26,"./processor":34,"cog/defaults":5,"cog/extend":6,"cog/getable":7,"cog/logger":9,"cog/throttle":10,cuid:30,mbus:22,"rtc-core/detect":18}],36:[function(e,t){"use strict";var n=e("cog/logger")("rtc/cleanup"),r=["closed"],o=["addstream","datachannel","icecandidate","negotiationneeded","removestream","signalingstatechange"],i=["iceconnectionstatechange"];t.exports=function(e){function t(t){t.forEach(function(t){e["on"+t]&&(e["on"+t]=null)})}var c=e.iceConnectionState,a=r.indexOf(c)<0;
t(o),a&&(n("attempting connection close, current state: "+e.iceConnectionState),e.close()),setTimeout(function(){t(i)},100)}},{"cog/logger":9}],37:[function(e,t){"use strict";function n(t,n,u,l){function f(){_("decoupling "+u.id+" from "+n),E.stop(),i(t),u.removeListener("sdp",p),u.removeListener("candidate",d),u.removeListener("negotiate",y)}function d(e){O.addIceCandidate(e)}function p(e,t){L("sdp.remote",e),t&&t.id===n&&O.setRemoteDescription(e)}function v(){_("captured pc close, iceConnectionState = "+t.iceConnectionState),f()}function g(){_("captured pc disconnect, monitoring connection status"),x=setTimeout(function(){_("manually closing connection after disconnect timeout"),t.close()},k),E.on("statechange",h)}function h(){return _("connection state changed to: "+t.iceConnectionState),w(),s.indexOf(t.iceConnectionState)>=0?E("closed"):void E.once("disconnect",g)}function m(e){e.candidate?(w(),L("ice.local",e.candidate),u.to(n).send("/candidate",e.candidate),S=!1):S||(S=!0,L("ice.gathercomplete"),u.to(n).send("/endofcandidates",{}))}function y(e){e.id===n&&(L("negotiate.request",e.id),j())}function w(){E.off("statechange",h),_("reset disconnect timer, state: "+t.iceConnectionState),clearTimeout(x)}var x,b=(l||{}).debugLabel||"rtc",_=e("cog/logger")(b+"/couple"),E=c(t,n,u,(l||{}).logger),L=r("",E),C=(l||{}).reactive,S=!0,k=(l||{}).disconnectTimeout||1e4,T=u.isMaster(n),O=o(t,l),A=a(function(){return T?void O.createOffer():u.to(n).send("/negotiate")},100,{leading:!1}),j=a(O.createOffer,100,{leading:!1});return C&&(t.onnegotiationneeded=function(){L("negotiate.renegotiate"),A()}),t.onicecandidate=m,O.on("sdp.local",function(e){u.to(n).send("/sdp",e)}),u.on("sdp",p),u.on("candidate",d),T&&u.on("negotiate",y),E.once("closed",v),E.once("disconnected",g),E.createOffer=A,E}var r=e("mbus"),o=e("rtc-taskqueue"),i=e("./cleanup"),c=e("./monitor"),a=e("cog/throttle"),s=["closed","failed"];t.exports=n},{"./cleanup":36,"./monitor":41,"cog/logger":9,"cog/throttle":10,mbus:22,"rtc-taskqueue":42}],38:[function(e,t){"use strict";t.exports=e("rtc-core/detect")},{"rtc-core/detect":18}],39:[function(e,t,n){"use strict";var r=e("cog/logger")("generators"),o=e("./detect"),i=e("cog/defaults"),c={create:{dtls:function(e){o.moz||(e.optional=(e.optional||[]).concat({DtlsSrtpKeyAgreement:!0}))}}};n.config=function(e){var t=(e||{}).iceServerGenerator;return i({},e,{iceServers:"function"==typeof t?t():[]})},n.connectionConstraints=function(e,t){var n,o={},a=c.create;return Object.keys(e||{}).forEach(function(e){a[e]&&a[e](o)}),n=i({},t,o),r("generated connection constraints: ",n),n}},{"./detect":38,"cog/defaults":5,"cog/logger":9}],40:[function(e,t,n){"use strict";var r=e("./generators"),o=n.detect=e("./detect"),i=e("rtc-core/plugin");n.logger=e("cog/logger");var c=n.RTCPeerConnection=o("RTCPeerConnection");n.couple=e("./couple"),n.createConnection=function(e,t){var n=i((e||{}).plugins),o=(e||{}).RTCPeerConnection||c,a=r.config(e);return t=r.connectionConstraints(e,t),n&&"function"==typeof n.createConnection?n.createConnection(a,t):new o(a,t)}},{"./couple":37,"./detect":38,"./generators":39,"cog/logger":9,"rtc-core/plugin":20}],41:[function(e,t){"use strict";function n(e){return o[e]||e}var r=e("mbus"),o={completed:"connected"},i=["signalingstatechange","iceconnectionstatechange"];t.exports=function(e,t,o,c){function a(){var t=n(e.iceConnectionState);f("statechange",e,t),l!==t&&(f(t),l=t)}function s(){f("closed")}function u(e){e===t&&f("closed")}var l,f=r("",c);return e.addEventListener("close",s),i.forEach(function(t){e.addEventListener(t,a)}),f.stop=function(){e.removeEventListener("close",s),i.forEach(function(t){e.removeEventListener(t,a)}),o&&"function"==typeof o.removeListener&&o.removeListener("peer:leave",u)},f.checkState=a,e?(l=n(e.iceConnectionState),o&&"function"==typeof o.on&&o.on("peer:leave",u),f):f}},{mbus:22}],42:[function(e,t){var n=e("rtc-core/detect"),r=e("rtc-core/plugin"),o=e("priorityqueuejs"),i=e("rtc-validator/candidate"),c=e("rtc-sdpclean"),a=100,s=1e3,u=["candidate","setLocalDescription","setRemoteDescription","createAnswer","createOffer"],l={setLocalDescription:"setlocaldesc",setRemoteDescription:"setremotedesc",createOffer:"offer",createAnswer:"answer"};t.exports=function(t,f){function d(e,n){var r,o=e.args[0];if(!o.candidate)return n();try{r=h(o),t.addIceCandidate(r),D("ice.remote.applied",r)}catch(e){return D("ice.remote.invalid",r),n(e)}n()}function p(){var e=!j.isEmpty()&&!A&&j.peek(),n=e&&T(e),r=!j.isEmpty()&&C(t);return P=0,n?(A=j.deq(),void A.fn(A,function(e){var t=A.fail||q,n=A.pass,r=A.name;return A=null,e?(console.error(r+" task failed: ",e),t(e)):("function"==typeof n&&n.apply(null,[].slice.call(arguments,1)),void O())})):r&&O()}function v(e){var n=[],r=e&&c(e.sdp,{collector:n});return e&&r!==e.sdp&&(console.info("invalid lines removed from sdp: ",n),e.sdp=r),"function"==typeof I&&(e.sdp=I(e.sdp,t,methodName)),e}function g(){return"have-remote-offer"===t.signalingState?D.createAnswer():void 0}function h(e){return R&&"function"==typeof R.createIceCandidate?R.createIceCandidate(e):new N(e)}function m(e){return R&&"function"==typeof R.createSessionDescription?R.createSessionDescription(e):new U(e)}function y(){D("sdp.local",t.localDescription)}function w(e,t,n){return function(){var r=[].slice.call(arguments);n&&"function"==typeof n.processArgs&&(r=r.map(n.processArgs)),j.enq({args:r,name:e,fn:t,checks:[C].concat((n||{}).checks||[]),pass:(n||{}).pass,fail:(n||{}).fail}),O()}}function x(e,n){function r(t){D.apply(D,["negotiate.error",e.name,t].concat(e.args)),n(t)}function o(){D.apply(D,[["negotiate",c,"ok"],e.name].concat(e.args)),n.apply(null,[null].concat([].slice.call(arguments)))}var i=t[e.name],c=l[e.name]||(e.name||"").toLowerCase(),a=[o,r],s="createOffer"===e.name;return"function"!=typeof i?n(new Error('cannot call "'+e.name+'" on RTCPeerConnection')):(D.apply(D,["negotiate."+c].concat(e.args)),void i.apply(t,e.args.concat(a).concat(s?_():[])))}function b(e){return e.srcElement&&e.candidate&&(e=e.candidate),e}function _(){var e={offertoreceivevideo:"OfferToReceiveVideo",offertoreceiveaudio:"OfferToReceiveAudio",icerestart:"IceRestart",voiceactivitydetection:"VoiceActivityDetection"},t={OfferToReceiveVideo:!0,OfferToReceiveAudio:!0};return Object.keys(f||{}).forEach(function(n){e[n.toLowerCase]&&(t[e[n.toLowerCase()]]=f[n])}),{mandatory:t}}function E(e){return e.__hasDesc||(e.__hasDesc=!!e.remoteDescription)}function L(e){return"have-local-offer"!==e.signalingState}function C(e){return"closed"!==e.signalingState}function S(e,t){return t.__valid||(t.__valid=0===i(t.args[0]).length)}function k(e,t){var n=[e,t],r=n.map(T),o=n.map(function(e,t){var n=r[t],o=n&&M.indexOf(e.name);return n?o>=0?o:a:s});return o[1]-o[0]}function T(e){return(e.checks||[]).reduce(function(n,r){return n&&r(t,e)},!0)}function O(){P||(P=setTimeout(p,50))}var A,j=new o(k),D=e("mbus")("",(f||{}).logger),M=(f||{}).priorities||u,R=r((f||{}).plugins),P=0,q=D.bind(D,"fail"),I=(f||{}).sdpfilter||(f||{}).sdpFilter,U=(f||{}).RTCSessionDescription||n("RTCSessionDescription"),N=(f||{}).RTCIceCandidate||n("RTCIceCandidate");return D.addIceCandidate=w("addIceCandidate",d,{processArgs:b,checks:[E,S]}),D.setLocalDescription=w("setLocalDescription",x,{processArgs:v,pass:y}),D.setRemoteDescription=w("setRemoteDescription",x,{processArgs:m,pass:g}),D.createOffer=w("createOffer",x,{checks:[L],pass:D.setLocalDescription}),D.createAnswer=w("createAnswer",x,{pass:D.setLocalDescription}),D}},{mbus:22,priorityqueuejs:43,"rtc-core/detect":18,"rtc-core/plugin":20,"rtc-sdpclean":44,"rtc-validator/candidate":45}],43:[function(e,t){function n(e){this._comparator=e||n.DEFAULT_COMPARATOR,this._elements=[]}t.exports=n,n.DEFAULT_COMPARATOR=function(e,t){return e instanceof Number&&t instanceof Number?e-t:(e=e.toString(),t=t.toString(),e==t?0:e>t?1:-1)},n.prototype.isEmpty=function(){return 0===this.size()},n.prototype.peek=function(){if(this.isEmpty())throw new Error("PriorityQueue is empty");return this._elements[0]},n.prototype.deq=function(){var e=this.peek(),t=this._elements.pop(),n=this.size();if(0===n)return e;this._elements[0]=t;for(var r=0;n>r;){var o=r,i=2*r+1,c=2*r+2;if(n>i&&this._compare(i,o)>0&&(o=i),n>c&&this._compare(c,o)>0&&(o=c),o===r)break;this._swap(o,r),r=o}return e},n.prototype.enq=function(e){for(var t=this._elements.push(e),n=t-1;n>0;){var r=Math.floor((n-1)/2);if(this._compare(n,r)<0)break;this._swap(r,n),n=r}return t},n.prototype.size=function(){return this._elements.length},n.prototype.forEach=function(e){return this._elements.forEach(e)},n.prototype._compare=function(e,t){return this._comparator(this._elements[e],this._elements[t])},n.prototype._swap=function(e,t){var n=this._elements[e];this._elements[e]=this._elements[t],this._elements[t]=n}},{}],44:[function(e,t){function n(e){var t=o.exec(e);return t&&t[0]}var r=[[/^(a\=candidate.*)$/,e("rtc-validator/candidate")]],o=/(\r?\n|\\r\\n)/;t.exports=function(e,t){var o=n(e),i=e.split(o),c=(t||{}).collector;return i=i.filter(function(e){var t=r.reduce(function(t,n){return"undefined"!=typeof t?t:n[0].exec(e)&&{line:e.replace(n[0],"$1"),fn:n[1]}},void 0),n=t?t.fn(t.line):[];return c&&n.forEach(function(e){c.push(e)}),0===n.length}),i.join(o)}},{"rtc-validator/candidate":45}],45:[function(e,t){function n(e,t){var n=c[t];return n&&!n[0].test(e)?(r(n[2]+" part failed validation: "+e),new Error(n[1])):void 0}var r=e("cog/logger")("rtc-validator"),o=/^(?:a=)?candidate:/,i=/^(\d+\.){3}\d+$/,c=[[/.+/,"invalid foundation component","foundation"],[/\d+/,"invalid component id","component-id"],[/(UDP|TCP)/i,"transport must be TCP or UDP","transport"],[/\d+/,"numeric priority expected","priority"],[i,"invalid connection address","connection-address"],[/\d+/,"invalid connection port","connection-port"],[/typ/,'Expected "typ" identifier',"type classifier"],[/.+/,"Invalid candidate type specified","candidate-type"]];t.exports=function(e){var t=[],r=e&&(e.candidate||e),i=r&&o.exec(r),c=i&&r.slice(i[0].length).split(/\s/);return r?i?t=t.concat(c.map(n)).filter(Boolean):[new Error("candidate did not match expected sdp line format")]:[new Error("empty candidate")]}},{"cog/logger":9}],46:[function(e,t){t.exports=function(e){return e=[].concat(e||[]).concat([].slice.call(arguments,1)),function(t){return e.reduce(function(e,t){var n=t(e);return void 0!==n?n:e},t||0)}}},{}]},{},[2])(2)});
//# sourceMappingURL=rtc.min.js.map